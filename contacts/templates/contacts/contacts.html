{% extends "dashboard/base.html" %}
{% load static %}

{% block title %}Contacts - Dashboard | Ezydevs Technologies{% endblock %}

{% block content %}
<section class="min-h-screen bg-gradient-to-br from-background via-gray-900 to-black text-gray-100 px-6 py-10">
  <div class="max-w-7xl mx-auto">

    <!-- Header -->
    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-8 animate-fadeIn">
      <div>
        <h1 class="text-3xl font-extrabold text-primary">ðŸ“¬ Contact Messages</h1>
        <p class="text-gray-400 mt-1">Manage messages sent from your websiteâ€™s contact form.</p>
      </div>

      <div class="mt-4 sm:mt-0">
        <form method="get" class="relative">
          <input 
            type="text" 
            name="q" 
            placeholder="Search by name or email..." 
            value="{{ request.GET.q }}"
            class="w-64 pl-10 pr-4 py-2 bg-gray-800 border border-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none placeholder-gray-400 text-gray-100"
          />
          <i class="fas fa-search absolute left-3 top-2.5 text-gray-400"></i>
        </form>
      </div>
    </div>

    <!-- Messages Table -->
    <div class="overflow-x-auto bg-gray-900/60 rounded-xl shadow-lg animate-fadeInUp">
      <table class="min-w-full text-left border-collapse">
        <thead class="bg-gray-800/70 text-gray-300 uppercase text-sm font-semibold">
          <tr>
            <th class="py-3 px-6">Name</th>
            <th class="py-3 px-6">Email</th>
            <th class="py-3 px-6 hidden md:table-cell">Subject</th>
            <th class="py-3 px-6">Date</th>
            <th class="py-3 px-6 text-center">Action</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-gray-700">
          {% for contact in contacts %}
            <tr class="hover:bg-gray-800/70 transition">
              <td class="py-3 px-6 font-semibold">{{ contact.name }}</td>
              <td class="py-3 px-6 text-blue-400">{{ contact.email }}</td>
              <td class="py-3 px-6 hidden md:table-cell">{{ contact.subject|truncatechars:40 }}</td>
              <td class="py-3 px-6 text-gray-400">{{ contact.created_at|date:"M d, Y" }}</td>
              <td class="py-3 px-6 text-center">
                <a href="{% url 'dashboard_contact_detail' contact.id %}" class="text-blue-400 hover:text-blue-300 font-medium">
                  View
                </a>
              </td>
            </tr>
          {% empty %}
            <tr>
              <td colspan="5" class="text-center py-6 text-gray-400">No contact messages yet.</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- Pagination -->
    {% if is_paginated %}
      <div class="mt-8 flex justify-center items-center space-x-3 animate-fadeIn">
        {% if page_obj.has_previous %}
          <a href="?page={{ page_obj.previous_page_number }}" class="px-4 py-2 bg-gray-800 rounded-lg hover:bg-gray-700 transition">Previous</a>
        {% endif %}

        <span class="px-4 py-2 bg-gray-700 rounded-lg">{{ page_obj.number }} / {{ page_obj.paginator.num_pages }}</span>

        {% if page_obj.has_next %}
          <a href="?page={{ page_obj.next_page_number }}" class="px-4 py-2 bg-gray-800 rounded-lg hover:bg-gray-700 transition">Next</a>
        {% endif %}
      </div>
    {% endif %}
  </div>
</section>

<!-- Animations -->
<style>
@keyframes fadeIn { from {opacity: 0;} to {opacity: 1;} }
@keyframes fadeInUp { from {opacity: 0; transform: translateY(20px);} to {opacity: 1; transform: translateY(0);} }
.animate-fadeIn { animation: fadeIn 0.8s ease-out forwards; }
.animate-fadeInUp { animation: fadeInUp 0.8s ease-out forwards; }
</style>
{% endblock %}
