{% extends 'base.html' %}
{% load static %}

{% block title %}Create Your Account | Ezydevs{% endblock %}

{% block content %}
<section class="min-h-screen flex items-center justify-center bg-gray-900">
    <div class="bg-gray-800 shadow-2xl rounded-2xl p-8 max-w-md w-full text-white animate__animated animate__fadeInUp">
        <!-- Logo & Title -->
        <div class="text-center mb-6">
            <img src="{% static 'img/ezydevs_logo.jpg' %}" alt="Ezydevs" class="mx-auto w-16 h-16">
            <h2 class="text-2xl font-bold mt-4">Create Your Account</h2>
            <p class="text-gray-400 text-sm">Join Ezydevs to access our innovative solutions.</p>
        </div>

        <!-- Django Form -->
        <form method="post" id="registerForm" novalidate>
            {% csrf_token %}

            <!-- Email -->
            <div class="mb-4">
                <label for="email" class="block text-sm font-semibold mb-1">Email Address</label>
                <input type="email" id="email" name="email" required
                    class="w-full px-4 py-2 rounded-lg bg-gray-700 text-white focus:ring-2 focus:ring-blue-500 focus:outline-none"
                    placeholder="you@example.com">
                <small id="emailFeedback" class="text-red-400 hidden"></small>
                {% if form.email.errors %}
                    <p class="text-red-400 text-sm mt-1">{{ form.email.errors.0 }}</p>
                {% endif %}
            </div>

            <!-- Password -->
            <div class="mb-4">
                <label for="password1" class="block text-sm font-semibold mb-1">Password</label>
                <input type="password" id="password1" name="password1" required
                    class="w-full px-4 py-2 rounded-lg bg-gray-700 text-white focus:ring-2 focus:ring-blue-500 focus:outline-none"
                    placeholder="••••••••">
                <div class="mt-1 h-2 bg-gray-600 rounded-full">
                    <div id="passwordStrength" class="h-2 rounded-full bg-red-500 w-1/4 transition-all duration-300"></div>
                </div>
                <small id="passwordFeedback" class="text-gray-400 text-sm"></small>
                {% if form.password1.errors %}
                    <p class="text-red-400 text-sm mt-1">{{ form.password1.errors.0 }}</p>
                {% endif %}
            </div>

            <!-- Confirm Password -->
            <div class="mb-4">
                <label for="password2" class="block text-sm font-semibold mb-1">Confirm Password</label>
                <input type="password" id="password2" name="password2" required
                    class="w-full px-4 py-2 rounded-lg bg-gray-700 text-white focus:ring-2 focus:ring-blue-500 focus:outline-none"
                    placeholder="••••••••">
                <small id="confirmFeedback" class="text-red-400 hidden"></small>
                {% if form.password2.errors %}
                    <p class="text-red-400 text-sm mt-1">{{ form.password2.errors.0 }}</p>
                {% endif %}
            </div>

            <!-- Submit -->
            <button type="submit"
                class="w-full bg-gradient-primary hover:brightness-110  transition duration-300 py-2 rounded-lg font-semibold">
                Sign Up
            </button>
        </form>

        <!-- Login Redirect -->
        <p class="mt-6 text-center text-gray-400 text-sm">
            Already have an account? 
            <a href="{% url 'login' %}" class="text-blue-400 hover:underline">Log in</a>
        </p>
    </div>
</section>

<!-- JS Live Feedback -->
<script>
document.addEventListener("DOMContentLoaded", function () {
    const emailInput = document.getElementById("email");
    const emailFeedback = document.getElementById("emailFeedback");
    const passwordInput = document.getElementById("password1");
    const passwordStrength = document.getElementById("passwordStrength");
    const passwordFeedback = document.getElementById("passwordFeedback");
    const confirmInput = document.getElementById("password2");
    const confirmFeedback = document.getElementById("confirmFeedback");

    // Email validation
    emailInput.addEventListener("input", () => {
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(emailInput.value)) {
            emailFeedback.textContent = "Invalid email format.";
            emailFeedback.classList.remove("hidden");
        } else {
            emailFeedback.classList.add("hidden");
        }
    });

    // Password strength
    passwordInput.addEventListener("input", () => {
        const val = passwordInput.value;
        let strength = 0;

        if (val.length >= 8) strength++;
        if (/[A-Z]/.test(val)) strength++;
        if (/[0-9]/.test(val)) strength++;
        if (/[^A-Za-z0-9]/.test(val)) strength++;

        const colors = ["bg-red-500", "bg-yellow-500", "bg-green-500"];
        passwordStrength.className = `h-2 rounded-full transition-all duration-300 ${colors[Math.min(strength, 3) - 1] || "bg-red-500"}`;
        passwordStrength.style.width = `${(strength / 4) * 100}%`;

        passwordFeedback.textContent = strength < 3 ? "Password too weak" : "Strong password";
    });

    // Confirm password
    confirmInput.addEventListener("input", () => {
        if (confirmInput.value !== passwordInput.value) {
            confirmFeedback.textContent = "Passwords do not match";
            confirmFeedback.classList.remove("hidden");
        } else {
            confirmFeedback.classList.add("hidden");
        }
    });
});
</script>
{% endblock %}
